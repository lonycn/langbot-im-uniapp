{"version":3,"file":"members.js","sources":["uni_modules/uni-im/pages/group/members.vue"],"sourcesContent":["<template>\n  <view class=\"group-members-box\">\n    <uni-search-bar v-model=\"keyword\" class=\"search-bar\" radius=\"5\" placeholder=\"输入昵称搜索\" clearButton=\"auto\"\n      cancelButton=\"none\"></uni-search-bar>\n    <view v-if=\"!leave_group\" class=\"members-list-container\" >\n      <view class=\"invite-box item\" v-if=\"isAdmin\">\n        <view class=\"invite-icon\">\n          <uni-icons @click=\"invite\" color=\"#989898\" size=\"20px\" type=\"plusempty\"></uni-icons>\n        </view>\n        <text class=\"invite-text\">邀请</text>\n      </view>\n      <template v-for=\"(member,index) in memberList\" :key=\"index\">\n        <view class=\"item\" :title=\"member.users.nickname\"\n          :class=\"{'pointer': canPrivateChat,'focus':member.focus}\" @click=\"toChat(member.users._id)\"\n          @longpress.prevent=\"openConversationMenu($event,index)\"\n          @contextmenu.prevent=\"openConversationMenu($event,index)\"\n          @mousemove=\"hoverUserId = member.users._id\"\n          >\n          <image class=\"avatar\" :src=\"(member.users.avatar_file && member.users.avatar_file.url) ? member.users.avatar_file.url:'/uni_modules/uni-im/static/avatarUrl.png'\"\n            mode=\"widthFix\"></image>\n          <text class=\"nickname\">{{member.users.nickname||'匿名用户'}}</text>\n          <text v-if=\"member.role.includes('admin')\" class=\"group-admin\">管</text>\n          <text v-if=\"!mute_all_members && member.mute_type\" class=\"mute-type-1\">已被禁言</text>\n        </view>\n      </template>\n    </view>\n    <view v-if=\"showLoadMoreBtn\" class=\"set-index-box\">\n      <text v-if=\"laterRenderIndex > 0\" class=\"item\" @click=\"laterRenderIndex = 0\" space=\"emsp\">收起</text>  \n      <view class=\"look-more-box\">\n        <text v-if=\"member.loading\" class=\"item\">加载中...</text>\n        <text v-else-if=\"!isAllShow\" class=\"item\" @click=\"lookMore\">查看更多</text>\n      </view>\n    </view>\n    <template v-else>\n      <text v-if=\"member.loading\" class=\"tip\">加载中...</text>\n      <text v-else-if=\"!member.hasMore\" class=\"tip\">没有更多了</text>\n    </template>\n    <uni-im-contextmenu ref=\"uni-im-contextmenu\"></uni-im-contextmenu>\n    <!-- #ifdef H5 -->\n    <uni-popup v-if=\"isWidescreen\" ref=\"invitePagePopup\" type=\"center\">\n      <invitePage class=\"invite-page\" ref=\"invitePage\" @done=\"$refs.invitePagePopup.close()\"></invitePage>\n    </uni-popup>\n    <!-- #endif -->\n  </view>\n</template>\n\n<script>\n  const db = uniCloud.database()\n  import uniIm from '@/uni_modules/uni-im/sdk/index.js';\n  // #ifdef H5\n  import invitePage from '@/uni_modules/uni-im/pages/contacts/createGroup/createGroup.vue'\n  // #endif\n  export default {\n    components: {\n      // #ifdef H5\n      invitePage\n      // #endif\n    },\n    data() {\n      return {\n        conversation: {\n          group: {\n            user_id: \"\",\n            mute_all_members: false,\n            member: {\n              dataList: []\n            }\n          },\n          mute: false\n        },\n        leave_group: false,\n        editorType: '',\n        editorDefaultValue: '',\n        groupType: '',\n        isAdmin: false,\n        keyword: '',\n        mute_all_members: false,\n        // 鼠标在哪个用户id上\n        hoverUserId: '',\n        // 延迟渲染，避免页面卡顿\n        laterRenderIndex: 0,\n        showLoadMoreBtn: true\n      };\n    },\n    computed: {\n      ...uniIm.mapState(['isWidescreen']),\n      member(){\n        return this.conversation.group.member\n      },\n      memberList() {\n        let memberList = this.member.dataList\n          // 根据关键词搜索\n          .filter(member => {\n            // 忽略大小写\n            return member.users.nickname.toLowerCase().includes(this.keyword.toLowerCase())\n          })\n          // 是管理员排序靠前\n          .sort((a, b) => {\n            if (a.role.includes('admin') && !b.role.includes('admin')) {\n              return -1\n            } else if (!a.role.includes('admin') && b.role.includes('admin')) {\n              return 1\n            } else {\n              return 0\n            }\n          })\n          .filter((item, index) => {\n            return index < this.canRenderCount\n          })\n        return memberList\n      },\n      // 允许被渲染的个数\n      canRenderCount() {\n        // 懒渲染的值*50，如果是管理员，减1（因为有一个“+邀请”用户加入群聊的占位）\n        let n = this.laterRenderIndex * 50 - (this.isAdmin ? 1 : 0)\n        // 如果是第一次渲染，则默认渲染10个，如果是管理员，则默认渲染9个（因为有一个“+邀请”用户加入群聊的占位）\n        if(this.laterRenderIndex === 0){\n          n = this.isAdmin ? 9 : 10\n        }\n        return n\n      },\n      // 剩余未渲染的个数\n      notRenderCount() {\n        return this.member.dataList.length - this.canRenderCount\n      },\n      // 是否全部显示（全部加载完毕，并全部被渲染）\n      isAllShow() {\n        return this.notRenderCount <= 0 && !this.member.hasMore\n      },\n      currentUid() {\n        return uniIm.currentUser._id\n      },\n      isGroupCreator() {\n        return this.conversation.group.user_id == this.currentUid\n      },\n      canPrivateChat(){\n        // 当前登录的账号是管理员，或者是群管理员，或者要私信管理员\n        return this.uniIDHasRole('staff') || \n              this.member.find(this.currentUid)?.role.includes('admin') ||\n              this.hoverUserId && this.member.find(this.hoverUserId).role.includes('admin') \n      }\n    },\n    onReachBottom() {\n      this.showMore()\n    },\n    watch: {\n      // （后续）通过监听实现实时切换管理员实时刷新权限\n      // console.log('isAdmin',isAdmin);\n      conversation: {\n        handler(conversation, oldValue) {\n          // 当前用户是群的创建者或者管理员（在群成员中找到当前用户的角色包含admin）\n          this.isAdmin = this.isGroupCreator || this.member.find(this.currentUid)?.role.includes('admin')\n          this.leave_group = conversation.leave\n          this.mute_all_members = conversation.group.mute_all_members\n        },\n        deep: true\n      },\n    },\n    props: {\n      conversation_id: {\n        default () {\n          return false\n        }\n      }\n    },\n    async onLoad(e) {\n      if (!e.conversation_id) {\n        throw new Error(\"会话id不能为空\")\n      }\n      this.load(e.conversation_id)\n      // 以页面模式加载时不需要显示加载更多按钮\n      this.showLoadMoreBtn = false\n      this.laterRenderIndex = 1\n    },\n    mounted() { //pc端以组件模式加载时逻辑\n      if (this.conversation_id) {\n        this.load(this.conversation_id)\n      }\n    },\n    methods: {\n      async load(conversation_id) {\n        this.conversation = await uniIm.conversation.get(conversation_id)\n      },\n      toChat(user_id) {\n        if (this.canPrivateChat) {\n          uniIm.toChat({\n            user_id,\n            source:{\n              group_id: this.conversation.group_id\n            }\n          })\n        }\n      },\n      showMore(){\n        if(this.notRenderCount < 5){\n          this.member.loadMore().then(() => {\n            this.laterRenderIndex++\n          })\n        }else{\n          this.laterRenderIndex++\n        }\n      },\n      lookMore() {\n        if(this.isWidescreen){\n          if(this.isAllShow){\n            this.laterRenderIndex = 0\n          }else{\n            this.showMore()\n          }\n        }else{\n          uni.navigateTo({\n            url: '/uni_modules/uni-im/pages/group/members?conversation_id=' + this.conversation.id,\n            animationType:\"slide-in-right\"\n          })\n        }\n      },\n      invite() {\n        const group_id = this.conversation.group._id\n        if (this.isWidescreen) {\n          this.$refs.invitePagePopup.open()\n          setTimeout(() => {\n            this.$refs.invitePage.setParam({group_id})\n          },0)\n        } else {\n          uni.navigateTo({\n            url: '/uni_modules/uni-im/pages/contacts/createGroup/createGroup?group_id=' + group_id\n          })\n        }\n      },\n      async expel(item) {\n        uni.showModal({\n          title: '确定要将该用户移出本群吗？',\n          content: '不能撤销，请谨慎操作',\n          cancelText: '取消',\n          confirmText: '确认',\n          complete: async (e) => {\n            // console.log(e);\n            if (e.confirm) {\n              uni.showLoading({\n                mask: true\n              });\n              try {\n                let res = await db.collection('uni-im-group-member').where({\n                    user_id: item.users._id,\n                    group_id: this.conversation.group._id\n                  })\n                  .remove()\n                if (res.result.deleted) {\n                  uni.showToast({\n                    title: '成功移除',\n                    icon: 'none',\n                    complete: () => {}\n                  });\n                  // console.log('exitGroup', res);\n                }\n              } catch (error) {\n                uni.showToast({\n                  title: error.message,\n                  icon: 'error',\n                  complete: () => {}\n                });\n              }\n              uni.hideLoading()\n            }\n          }\n        });\n      },\n      async expelAndToBlack(item) {\n      \n        uni.showModal({\n          title: '确定要将该用户移出本群并拉黑吗？',\n          content: '拉黑后此用户将不能再次加入本群，不能撤销，请谨慎操作',\n          cancelText: '取消',\n          confirmText: '确认',\n          complete: async (e) => {\n            // console.log(e);\n            if (e.confirm) {\n              uni.showLoading({\n                mask: true\n              });\n              try {\n                let res = await db.collection('uni-im-group-member').where({\n                    user_id: item.users._id,\n                    group_id: this.conversation.group._id\n                  })\n                  .remove()\n                console.log('expel', res);\n                const uniImCo = uniCloud.importObject(\"uni-im-co\")\n                res = await uniImCo.addToGroupMenberBlackList({\n                  user_id: item.users._id,\n                  group_id: this.conversation.group._id\n                })\n                console.log('expelAndToBlack', res);\n              } catch (error) {\n                uni.showToast({\n                  title: error.message,\n                  icon: 'error',\n                  complete: () => {}\n                });\n              }\n              uni.hideLoading()\n            }\n          }\n        });\n      },\n      async changeMemberMute(item) {\n        let nickname = item.users.nickname || '匿名用户'\n        uni.showModal({\n          title: '确定要' + (item.mute_type ? `为\"${nickname}\"解除禁言吗？` : `禁言\"${nickname}\"吗？`),\n          cancelText: '取消',\n          confirmText: '确认',\n          complete: async (e) => {\n            // console.log(e);\n            if (e.confirm) {\n              uni.showLoading({\n                mask: true\n              });\n              try {\n                let res = await db.collection('uni-im-group-member').where({\n                    _id: item._id,\n                    mute_type: item.mute_type // 防止此时云端已经变化\n                  })\n                  .update({\n                    mute_type: item.mute_type ? 0 : 1\n                  })\n                // console.log('mute_type', res);\n                if (res.result.updated) {\n                  item.mute_type = item.mute_type ? 0 : 1\n      \n                  uni.showToast({\n                    title: '设置成功',\n                    icon: 'none',\n                    complete: () => {}\n                  });\n                }\n              } catch (error) {\n                // console.log('error',merror)\n                uni.showToast({\n                  title: error.message,\n                  icon: 'error',\n                  complete: () => {}\n                });\n              }\n              uni.hideLoading()\n            }\n          }\n        });\n      },\n      openConversationMenu(event, index) {\n        if (!this.isAdmin) {\n          return\n        }\n        const member = this.memberList[index]\n        const menuList = []\n        menuList.unshift({\n          \"title\": \"移除\",\n          \"action\": () => {\n            // console.log('移除');\n            this.expel(member)\n          }\n        })\n            \n        menuList.unshift({\n          \"title\": \"移除并拉黑\",\n          \"action\": () => {\n            console.log('移除并拉黑');\n            this.expelAndToBlack(member)\n          }\n        })\n            \n        if (!this.conversation.group.mute_all_members) {\n          menuList.unshift({\n            \"title\": member.mute_type ? \"解除禁言\" : '设为禁言',\n            \"action\": () => {\n              // console.log('禁言');\n              this.changeMemberMute(member)\n            }\n          })\n        }\n            \n        const isAdmin = member.role.includes('admin')\n        menuList.push({\n          \"title\": isAdmin ? \"取消管理员\" : \"设置管理员\",\n          \"action\": () => {\n            let role = member.role;\n            if (isAdmin) {\n              // console.log('取消管理员');\n              role = member.role.filter(item => item !== 'admin')\n            } else {\n              role.push('admin')\n              // console.log('设置管理员');\n            }\n            uni.showLoading({\n              mask: true\n            });\n            db.collection('uni-im-group-member').doc(member._id).update({\n                \"role\": role\n              }).then(res => {\n                // console.log('res', res);\n                member.role = role\n              })\n              .catch(err => {\n                console.error(err)\n                uni.showToast({\n                  title: err.message,\n                  icon: 'none'\n                });\n              })\n              .finally(() => {\n                uni.hideLoading()\n              })\n          }\n        })\n      \n        if (menuList.length > 0) {\n          member.focus = true\n          const myContextmenu = this.$refs['uni-im-contextmenu']\n          let position = {\n            \"top\": event.touches[0].screenY || event.touches[0].clientY,\n            \"left\": event.touches[0].screenX || event.touches[0].clientX\n          }\n          if(event.type === 'contextmenu'){\n            position = {\n              \"top\": event.clientY,\n              \"left\": event.clientX,\n            }\n          }\n      \n          // #ifdef H5\n          position.top = position.top + 120\n          // #endif\n      \n          myContextmenu.show(position, menuList)\n          myContextmenu.onClose(() => {\n            member.focus = false\n          })\n        }\n      },\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n@import \"@/uni_modules/uni-im/common/baseStyle.scss\";\n.group-members-box {\n  width: 750rpx;\n  background-color: #f5f5f5;\n  .members-list-container {\n    width: 750rpx;\n    flex-direction: row;\n    flex-wrap: wrap;\n    .item {\n      position: relative;\n      width: 150rpx;\n      height: 140rpx;\n      margin: 5px 0;\n      align-items: center;\n      justify-content: space-around;\n    }\n    .invite-icon {\n      border: 1px dashed #ccc;\n      border-radius: 10px;\n      width: 90rpx;\n      height: 90rpx;\n      justify-content: center;\n      cursor: pointer;\n    }\n  }\n  \n  /* #ifdef H5 */\n  .windows .item {\n    width: 146rpx;\n  }\n  /* #endif */\n  \n  .item.focus {\n    border: 1px dashed #ccc;\n  }\n  \n  .group-admin {\n    position: absolute;\n    top: 5px;\n    right: 5px;\n    padding: 1px 3px;\n    border-radius: 6px;\n    background-color: #e64141;\n    color: #fff;\n    font-size: 12px;\n  }\n  \n  .mute-type-1 {\n    position: absolute;\n    padding: 1px 10px;\n    background-color: #0b60ff;\n    color: #fff;\n    font-size: 10px;\n    bottom: 28px;\n  }\n  \n  /* #ifdef H5 */\n  .pointer {\n    cursor: pointer;\n  }\n  /* #endif */\n  \n  .avatar {\n    width: 100rpx;\n    height: 100rpx;\n    border-radius: 10px;\n    box-shadow: 0 0 1px #aaa;\n  }\n  \n  .invite-text,.nickname {\n    width: 140rpx;\n    text-align: center;\n    font-size: 12px;\n    color: #666;\n    padding: 0 16rpx;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n  }\n  \n  .tip {\n    text-align: center;\n    font-size: 14px;\n    color: #666;\n    height: 60px;\n    line-height: 60px;\n  }\n  \n  .set-index-box {\n    flex-direction: row;\n    justify-content: center;\n    .look-more-box {\n      flex-direction: row;\n      justify-content: center;\n    }\n    .item {\n      margin:0 10px;\n      text-align: center;\n      font-size: 14px;\n      color: #666;\n      height: 40px;\n      line-height: 40px;\n    }\n    /* #ifdef H5 */\n    .item {\n      cursor: pointer;\n    }\n    .item:hover {\n      color: #333;\n    }\n    /* #endif */\n  }\n  .invite-page {\n    border-radius: 10px;\n    background-color: #fff;\n    overflow: hidden;\n    .header-box {\n      padding-top: 5px;\n    }\n  }\n}\n\n  \n</style>"],"names":["uniCloud","uniIm","uni"],"mappings":"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"}