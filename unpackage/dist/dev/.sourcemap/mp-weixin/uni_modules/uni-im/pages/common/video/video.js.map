{"version":3,"file":"video.js","sources":["uni_modules/uni-im/pages/common/video/video.vue","uni_modules/uni-im/pages/common/video/video.vue?type=page"],"sourcesContent":["<template>\n  <view v-if=\"url\" class=\"video-box\" :class=\"{'is-float-mode':mode == 'float'}\" @click=\"showCloseBtnFn\">\n    <view class=\"mask\" v-if=\"mode == 'float'\"></view>\n  \t<video ref=\"video\" @click=\"showCloseBtnFn\" :src=\"url\" :autoplay=\"true\" :page-gesture=\"true\" :show-mute-btn=\"true\" :show-fullscreen-btn=\"mode == 'float'\" class=\"video\"></video>\n\t\t<cover-view class=\"close-icon\" @click=\"close\">关闭</cover-view>\n  </view>\n</template>\n\n<script>\nimport uniIm from '@/uni_modules/uni-im/sdk/index.js';\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\turl:\"\",\n\t\t\t\tshowCloseBtn:true,\n        // 全屏模式和小窗模式，fullscreen为全屏模式，float为小窗模式\n        mode: 'fullscreen',\n\t\t\t};\n\t\t},\n\t\tonLoad({url}) {\n\t\t\t// console.log({url});\n\t\t\tthis.url = url\n\t\t\tsetTimeout(()=> {\n\t\t\t\tthis.showCloseBtn = false\n\t\t\t}, 1000);\n\t\t},\n    mounted(){\n      // console.log('mounted');\n      uni.$on('uni-im-playVideo',(url)=>{\n        this.mode = 'float'\n        this.url = url\n        this.showCloseBtn = true\n      })\n      \n      // 监听esc按键，关闭视频\n      // #ifdef H5\n      uniIm.utils.appEvent.onKeyDown(evt => this.onDownEscapeKey(), {\n        order: 1000,\n        match: {\n          key: 'Escape',\n          altKey: false,\n          ctrlKey: false,\n          shiftKey: false,\n        }\n      })\n      // #endif\n    },\n    beforeDestroy(){\n      // #ifdef H5\n      uniIm.utils.appEvent.offKeyDown(this.onDownEscapeKey)\n      // #endif\n    },\n\t\tmethods:{\n      onDownEscapeKey() {\n        if (this.url.length) {\n          this.close()\n        }\n        return true\n      },\n\t\t\tclose(){\n        if(this.mode == 'fullscreen'){\n          uni.navigateBack()\n        }else{\n          this.url = ''\n        }\n\t\t\t},\n\t\t\tshowCloseBtnFn(){\n\t\t\t\tconsole.log('showCloseBtnFn');\n\t\t\t\tthis.showCloseBtn = true\n        if(this.mode == 'fullscreen'){\n          setTimeout(()=> {\n          \tthis.showCloseBtn = false\n          }, 5000);\n        }\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\">\n@import \"@/uni_modules/uni-im/common/baseStyle.scss\";\n\npage {\n  height: 100%;\n}\n.video-box {\n  flex: 1;\n  .video{\n    width: 100vw;\n    height: 100%;\n  }\n\t.close-icon{\n  \tposition: absolute;\n  \ttop: 35px;\n  \tleft: 20px;\n  \tz-index: 9;\n\t\tcolor: #CCC;\n\t\tborder: 1px solid #CCC;\n\t\tbackground-color: rgba(0, 0, 0, 0.5);\n\t\tborder-radius: 10px;\n\t\tfont-size: 14px;\n\t\ttext-align: center;\n\t\tpadding: 0 10px;\n\t\t/* #ifdef H5 */\n    cursor: pointer;\n    /* #endif */ \n\t}\n  &.is-float-mode,\n  &.is-float-mode .video{\n  \tposition: fixed;\n  \ttop: 10vh;\n    left: calc(10vw + 250px);\n    width: calc(80vw - 220px) !important;\n    height: 80vh !important;\n    z-index: 9;\n  }\n  .mask {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 1;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/orange/aicode/langbot/web_client/langbot-im-uniapp/uni_modules/uni-im/pages/common/video/video.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;;AAUC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,KAAI;AAAA,MACJ,cAAa;AAAA;AAAA,MAET,MAAM;AAAA;EAEX;AAAA,EACD,OAAO,EAAC,IAAG,GAAG;AAEb,SAAK,MAAM;AACX,eAAW,MAAK;AACf,WAAK,eAAe;AAAA,IACpB,GAAE,GAAI;AAAA,EACP;AAAA,EACC,UAAS;AAEPA,kBAAAA,MAAI,IAAI,oBAAmB,CAAC,QAAM;AAChC,WAAK,OAAO;AACZ,WAAK,MAAM;AACX,WAAK,eAAe;AAAA,KACrB;AAAA,EAcF;AAAA,EACD,gBAAe;AAAA,EAId;AAAA,EACH,SAAQ;AAAA,IACJ,kBAAkB;AAChB,UAAI,KAAK,IAAI,QAAQ;AACnB,aAAK,MAAM;AAAA,MACb;AACA,aAAO;AAAA,IACR;AAAA,IACJ,QAAO;AACF,UAAG,KAAK,QAAQ,cAAa;AAC3BA,sBAAAA,MAAI,aAAa;AAAA,aACd;AACH,aAAK,MAAM;AAAA,MACb;AAAA,IACJ;AAAA,IACD,iBAAgB;AACfA,oBAAAA,MAAA,MAAA,OAAA,yDAAY,gBAAgB;AAC5B,WAAK,eAAe;AAChB,UAAG,KAAK,QAAQ,cAAa;AAC3B,mBAAW,MAAK;AACf,eAAK,eAAe;AAAA,QACpB,GAAE,GAAI;AAAA,MACT;AAAA,IACL;AAAA,EACD;AACD;;;;;;;;;;;;;;;;AC3ED,GAAG,WAAW,eAAe;"}