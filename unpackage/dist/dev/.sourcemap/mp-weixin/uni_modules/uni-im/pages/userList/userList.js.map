{"version":3,"file":"userList.js","sources":["uni_modules/uni-im/pages/userList/userList.vue","uni_modules/uni-im/pages/userList/userList.vue?type=page"],"sourcesContent":["<template>\n\t<view>\n\t\t<unicloud-db ref=\"udb\" @load=\"handleLoad\" v-slot:default=\"{ data, loading, pagination, error, options }\"\n\t\t\tcollection=\"uni-id-users\" field=\"_id,nickname,avatar_file\" :where=\"udbWhere\">\n\t\t\t<view v-if=\"error\" class=\"error\">\n\t\t\t\t<text>{{ error.message }}</text>\n\t\t\t</view>\n\t\t\t<uni-list v-else :border=\"false\">\n\t\t\t\t<uni-im-info-card v-for=\"(item, index) in data\" :key=\"item._id\" link\n\t\t\t\t\t:title=\"item.nickname\"\n\t\t\t\t\t:avatar=\"item.avatar_file?.url || '/uni_modules/uni-im/static/avatarUrl.png'\"\n\t\t\t\t\t@click=\"toChat(item._id)\"></uni-im-info-card>\n\t\t\t</uni-list>\n\t\t\t<uni-im-load-state :status=\"loading ? 'loading' : loadMoreStatus\"></uni-im-load-state>\n\t\t</unicloud-db>\n\t</view>\n</template>\n<script>\nimport uniIm from '@/uni_modules/uni-im/sdk/index.js';\n\texport default {\n\t\tonLoad() {\n\t\t},\n\t\tcomputed: {\n\t\t\t//是否为pc宽屏（width>960px）\n\t\t\tisWidescreen(){\n\t\t\t\treturn uniIm.isWidescreen\n\t\t\t},\n\t\t},\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tloadMoreStatus: 'more',\n\t\t\t\tudbWhere: '', //'_id != $cloudEnv_uid',\n\t\t\t};\n\t\t},\n\t\tonPullDownRefresh() {\n\t\t\tthis.$refs.udb.loadData({\n\t\t\t\t\tclear: true\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tuni.stopPullDownRefresh();\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\tonReachBottom() {\n\t\t\tthis.$refs.udb.loadMore();\n\t\t},\n\t\tonNavigationBarButtonTap(e) {\n\t\t\tconsole.log(e);\n\t\t\tif (e.index) {\n\t\t\t\tlet data = uni.getStorageInfoSync();\n\t\t\t\tconsole.log('data.keys', JSON.stringify(data.keys));\n\t\t\t\tdata.keys.forEach(item => {\n\t\t\t\t\tif (item.includes('uni-im-msg:') || item.includes('uni-im-conversation')) {\n\t\t\t\t\t\t// console.log(item);\n\t\t\t\t\t\tuni.removeStorageSync(item);\n\t\t\t\t\t\tconsole.log(uni.getStorageSync(item));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: 'clear storage ok',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '/uni_modules/uni-id-pages/pages/login/login-withpwd',\n\t\t\t\t\tcomplete: e => {\n\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tmethods: {\n\t\t\thandleLoad(data, ended) {\n\t\t\t\tthis.loadMoreStatus = ended ? 'noMore' :\n\t\t\t\t'more'; // oading 的状态，可选值：more（loading前）、loading（loading中）、noMore（没有更多了）\n\t\t\t},\n\t\t\tasync toChat(user_id) {\n\t\t\t\t// 当前用户给对方发个消息\n\t\t\t\tif (this.isWidescreen) {\n\t\t\t\t\t//若为宽屏，则触发右侧详情页的自定义事件，通知右侧窗体刷新详情\n          location.href = '/#/uni_modules/uni-im/pages/index/index?user_id=' + user_id\n\t\t\t\t} else {\n\t\t\t\t\t// 若为窄屏，则打开新窗体，在新窗体打开详情页面\n\t\t\t\t\tuni.navigateTo({\n\t\t\t\t\t\turl: '/uni_modules/uni-im/pages/chat/chat?user_id=' + user_id\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\ttoAdd() {\n\t\t\t\tuni.navigateTo({\n\t\t\t\t\turl: '../uni-id-users/add',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t// 为指定事件添加一个监听器，获取被打开页面传送到当前页面的数据\n\t\t\t\t\t\trefreshData: () => {\n\t\t\t\t\t\t\tthis.$refs.udb.loadData({\n\t\t\t\t\t\t\t\tclear: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n</script>\n<style lang=\"scss\">\n  @import \"@/uni_modules/uni-im/common/baseStyle.scss\";\n</style>","import MiniProgramPage from '/Users/orange/aicode/langbot/web_client/langbot-im-uniapp/uni_modules/uni-im/pages/userList/userList.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniIm","uni","e"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAmBC,MAAK,YAAU;AAAA,EACd,SAAS;AAAA,EACR;AAAA,EACD,UAAU;AAAA;AAAA,IAET,eAAc;AACb,aAAOA,4BAAK,MAAC;AAAA,IACb;AAAA,EACD;AAAA,EACD,OAAO;AACN,WAAO;AAAA,MACN,gBAAgB;AAAA,MAChB,UAAU;AAAA;AAAA;EAEX;AAAA,EACD,oBAAoB;AACnB,SAAK,MAAM,IAAI;AAAA,MAAS;AAAA,QACtB,OAAO;AAAA,MACP;AAAA,MACD,MAAM;AACLC,sBAAG,MAAC,oBAAmB;AAAA,MACxB;AAAA;EAED;AAAA,EACD,gBAAgB;AACf,SAAK,MAAM,IAAI;EACf;AAAA,EACD,yBAAyB,GAAG;AAC3BA,kBAAAA,MAAY,MAAA,OAAA,wDAAA,CAAC;AACb,QAAI,EAAE,OAAO;AACZ,UAAI,OAAOA,oBAAI;AACfA,+FAAY,aAAa,KAAK,UAAU,KAAK,IAAI,CAAC;AAClD,WAAK,KAAK,QAAQ,UAAQ;AACzB,YAAI,KAAK,SAAS,aAAa,KAAK,KAAK,SAAS,qBAAqB,GAAG;AAEzEA,8BAAI,kBAAkB,IAAI;AAC1BA,wBAAA,MAAA,MAAA,OAAA,wDAAYA,cAAAA,MAAI,eAAe,IAAI,CAAC;AAAA,QACrC;AAAA,MACD,CAAC;AACDA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACP,CAAC;AAAA,WACK;AACNA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,QACL,UAAU,CAAAC,OAAK;AACdD,wBAAAA,MAAY,MAAA,OAAA,wDAAAC,EAAC;AAAA,QACd;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,WAAW,MAAM,OAAO;AACvB,WAAK,iBAAiB,QAAQ,WAC9B;AAAA,IACA;AAAA,IACK,OAAO,SAAS;AAAA;AAErB,YAAI,KAAK,cAAc;AAEjB,mBAAS,OAAO,qDAAqD;AAAA,eACpE;AAEND,wBAAAA,MAAI,WAAW;AAAA,YACd,KAAK,iDAAiD;AAAA,UACvD,CAAC;AAAA,QACF;AAAA,MACA;AAAA;AAAA,IACD,QAAQ;AACPA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,QACL,QAAQ;AAAA;AAAA,UAEP,aAAa,MAAM;AAClB,iBAAK,MAAM,IAAI,SAAS;AAAA,cACvB,OAAO;AAAA,YACR,CAAC;AAAA,UACF;AAAA,QACD;AAAA,MACD,CAAC;AAAA,IACF;AAAA,EACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpGF,GAAG,WAAW,eAAe;"}