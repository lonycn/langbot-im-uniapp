{"version":3,"file":"onNotification.js","sources":["uni_modules/uni-im/sdk/init/onNotification.js"],"sourcesContent":["import $state from '@/uni_modules/uni-im/sdk/state/index.js';\nconst current_uid = $state.currentUser._id\nexport default res => {\n  res.data.create_time = Date.now()\n  res.data.is_read = res.data.is_read || false\n  console.log('res.data notification.add', res.data)\n  res.data._id = res.data.payload.notificationId\n  const notificationData = res.data\n  delete res.data.payload.notificationId\n  delete res.data.unipush_version\n  $state.notification.add(res.data)\n  const {data} = notificationData?.payload || {}\n  const actions = {\n    \"uni-im-friend-delete\"(){\n      const friend_uid = data.from_uid == current_uid ? data.to_uid : data.from_uid\n      $state.friend.remove(friend_uid)\n    },\n    async \"uni-im-friend-add\"(){\n      const friend_uid = data.from_uid == current_uid ? data.to_uid : data.from_uid\n      let friendInfo = await $state.users.get(friend_uid)\n      console.log('friendInfo',friendInfo)\n      $state.friend.add(friendInfo)\n    }\n  }\n  \n  try{\n    console.log(777,notificationData?.payload?.subType, notificationData)\n    const action = actions[notificationData?.payload?.subType]\n    action && action()\n  }catch(e){\n    console.error(e, notificationData)\n  }\n  \n  \n}"],"names":["$state","uni"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AACA,MAAM,cAAcA,kCAAAA,MAAO,YAAY;AACvC,MAAA,iBAAe,SAAO;;AACpB,MAAI,KAAK,cAAc,KAAK,IAAK;AACjC,MAAI,KAAK,UAAU,IAAI,KAAK,WAAW;AACvCC,gBAAY,MAAA,MAAA,OAAA,sDAAA,6BAA6B,IAAI,IAAI;AACjD,MAAI,KAAK,MAAM,IAAI,KAAK,QAAQ;AAChC,QAAM,mBAAmB,IAAI;AAC7B,SAAO,IAAI,KAAK,QAAQ;AACxB,SAAO,IAAI,KAAK;AAChBD,oCAAAA,MAAO,aAAa,IAAI,IAAI,IAAI;AAChC,QAAM,EAAC,KAAI,KAAI,qDAAkB,YAAW,CAAE;AAC9C,QAAM,UAAU;AAAA,IACd,yBAAwB;AACtB,YAAM,aAAa,KAAK,YAAY,cAAc,KAAK,SAAS,KAAK;AACrEA,8CAAO,OAAO,OAAO,UAAU;AAAA,IAChC;AAAA,IACK,sBAAqB;AAAA;AACzB,cAAM,aAAa,KAAK,YAAY,cAAc,KAAK,SAAS,KAAK;AACrE,YAAI,aAAa,MAAMA,kCAAAA,MAAO,MAAM,IAAI,UAAU;AAClDC,sBAAAA,MAAA,MAAA,OAAA,uDAAY,cAAa,UAAU;AACnCD,gDAAO,OAAO,IAAI,UAAU;AAAA,MAC7B;AAAA;AAAA,EACF;AAED,MAAG;AACDC,wBAAA,MAAA,OAAA,uDAAY,MAAI,0DAAkB,YAAlB,mBAA2B,SAAS,gBAAgB;AACpE,UAAM,SAAS,SAAQ,0DAAkB,YAAlB,mBAA2B,OAAO;AACzD,cAAU,OAAQ;AAAA,EACnB,SAAM,GAAE;AACPA,kBAAAA,MAAA,MAAA,SAAA,uDAAc,GAAG,gBAAgB;AAAA,EAClC;AAGH;;"}